<?php/*function getXLS($xls){    include_once EXCEL_DIR.'PHPExcel/IOFactory.php';    $objPHPExcel = PHPExcel_IOFactory::load($xls);    $objPHPExcel->setActiveSheetIndex(0);    $aSheet = $objPHPExcel->getActiveSheet();    //этот массив будет содержать массивы содержащие в себе значения ячеек каждой строки    $array = array();    //получим итератор строки и пройдемся по нему циклом    foreach($aSheet->getRowIterator() as $row){    //получим итератор ячеек текущей строки    $cellIterator = $row->getCellIterator();    //пройдемся циклом по ячейкам строки    //этот массив будет содержать значения каждой отдельной строки    $item = array();    foreach($cellIterator as $cell){    //заносим значения ячеек одной строки в отдельный массив    array_push($item, $cell->getCalculatedValue());    }    //заносим массив со значениями ячеек отдельной строки в "общий массв строк"    array_push($array, $item);    }    return $array;}$xlsData = getXLS('1.xls'); //извлеаем данные из XLS*///define('EXCEL_DIR', iconv('utf-8', 'windows-1251', 'F:/_Скрипты разработка/phpexcel2/Classes/'));//include_once EXCEL_DIR.'PHPExcel.php';//require_once EXCEL_DIR.'PHPExcel/IOFactory.php';//$objPHPExcel = PHPExcel_IOFactory::load("1.xls");//var_dump($objPHPExcel);//echo '<pre>'; print_r($xlsData); echo '</pre>';/* // Загрузка непустых листов по порядку в массив в кодировке виндовс$data = new Spreadsheet_Excel_Reader("data.xls", false, 'windows-1251');$info = array();foreach ($data->sheets as $key => $sheet) {    if (!empty($sheet['cells'])) {        $info = array_merge($info, $sheet['cells']);    }}*/include_once 'excel_reader2.php';$data = new Spreadsheet_Excel_Reader("1.xls", false);header("Content-Type: text/html; charset=utf-8");//echo '<pre>'; print_r($data); echo '</pre>';foreach ($data->boundsheets as $k => $v) {	echo '<a href="?sheet='.$k.'">'.$v['name'].'</a> &nbsp; ';}if (isset($_GET['sheet'])) {    echo '<br /><br />';	//echo '<pre>'; print_r($data->sheets[$_GET['sheet']]); echo '</pre>';	//$sheet = array();	    echo '    <style>    TABLE.optionstable {empty-cells:show; border-collapse:collapse;}    TABLE.optionstable TH {background-color: #eee}    TABLE.optionstable TH, TABLE.optionstable TD {border:1px solid #ccc; padding: 2px 4px; vertical-align: top;}    </style>    <table class="optionstable">';    foreach ($data->sheets[$_GET['sheet']]['cells'] as $cell => $values) {    	//$sheet [][]= ;    	$str = trim(implode(' ', $values));        if (empty($str)) {        	continue;        }        echo '<tr>';        //array_shift($values);        foreach ($values as $k => $v) {    	   echo '<td>'.$v.'</td>';        }    	echo '</tr>';    }    echo '</table>';        unset($data->sheets[$_GET['sheet']]['cells']);        echo '<pre>'; print_r($data->sheets[$_GET['sheet']]); echo '</pre>';    }////echo count($data['sheets']);?>